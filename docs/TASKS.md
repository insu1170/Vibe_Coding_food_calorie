# AI 식단 관리 서비스 개발 Task 분리

## 프로젝트 개요
PRD를 기반으로 한 MVP/프로토타입 버전 개발을 위한 체계적인 task 분리입니다.

## 개발 단계별 Task 구조

### 🚀 Phase 1: 프로젝트 기초 설정
#### 1.1 프로젝트 구조 및 환경 설정
- [ ] **Next.js App Router 프로젝트 구조 최적화**
  - app 디렉토리 구조 검토 및 최적화
  - API routes 구조 설정 (/api/auth, /api/meals 등)
  - 유틸리티 함수 구조 설정

- [ ] **환경 변수 설정 (Supabase, n8n)**
  - `.env.local` 파일 생성 및 설정
  - Supabase 프로젝트 연결 설정
  - n8n 웹훅 URL 설정
  - 환경 변수 타입 정의

- [ ] **TypeScript 타입 정의 설정**
  - 공통 타입 정의 (User, Meal, FoodItem 등)
  - API 응답 타입 정의
  - 에러 타입 정의

#### 1.2 Supabase 테이블 및 인증 설정
- [ ] **Supabase 프로젝트 초기 설정**
  - Supabase 프로젝트 생성 및 연결
  - 인증 설정 (이메일 인증 활성화)

- [ ] **데이터베이스 스키마 설계 및 생성**
  - `food_logs` 테이블 설계 및 생성
  - `users` 테이블 (Supabase Auth와 연동)
  - RLS (Row Level Security) 정책 설정

- [ ] **Supabase Storage 설정**
  - 식단 이미지 저장용 버킷 생성
  - 스토리지 접근 권한 설정

### 🔐 Phase 2: 사용자 인증 시스템
#### 2.1 Next.js 사용자 인증 시스템 구현
- [ ] **Supabase Auth 클라이언트 설정**
  - Supabase 클라이언트 초기화
  - Auth context provider 생성

- [ ] **로그인/회원가입 UI 구현**
  - 로그인 페이지 (/auth/signin)
  - 회원가입 페이지 (/auth/signup)
  - 이메일 인증 처리

- [ ] **인증 미들웨어 및 보호**
  - protected route 설정
  - auth 상태 관리
  - 로그아웃 기능

### 🔄 Phase 3: n8n 웹훅 연동
#### 3.1 n8n 웹훅 엔드포인트 설정
- [ ] **n8n 웹훅 생성 및 설정**
  - n8n 워크플로우 기본 구조 생성
  - 웹훅 트리거 설정
  - 기본 에러 핸들링

#### 3.2 Next.js에서 n8n으로 이미지 업로드 API 구현
- [ ] **이미지 업로드 API 엔드포인트**
  - `/api/upload` 엔드포인트 생성
  - multipart/form-data 처리
  - 이미지 유효성 검증

- [ ] **n8n 연동 서비스 함수**
  - n8n API 호출 함수 구현
  - 응답 처리 및 에러 핸들링
  - 재시도 로직 구현

### 🤖 Phase 4: n8n 자동화 워크플로우
#### 4.1 n8n 시간 기반 끼니 자동 분류 워크플로우
- [ ] **시간 기반 분류 로직 구현**
  - 현재 시간 기반 끼니 판별 함수
  - 아침(04:00-10:59), 점심(11:00-16:59), 저녁(17:00-21:59), 간식(22:00-03:59)

- [ ] **데이터 검증 및 처리**
  - 웹훅 데이터 유효성 검증
  - mealType 변수 생성 및 전달

#### 4.2 n8n AI 식품 분석 통합
- [ ] **외부 AI 서비스 연동**
  - AI 식품 분석 API 연동 설정
  - 분석 결과 처리 및 파싱
  - 신뢰도(confidence) 임계값 설정

#### 4.3 n8n Supabase 저장 및 연동 워크플로우
- [ ] **Supabase Storage 연동**
  - 이미지 파일 업로드
  - 업로드된 이미지 URL 반환

- [ ] **Database 저장 로직**
  - `food_logs` 테이블에 데이터 삽입
  - 트랜잭션 처리
  - 에러 발생 시 롤백 처리

### 📱 Phase 5: 사용자 인터페이스
#### 5.1 랜딩페이지 (완료 ✅)
- [x] **MealLog 랜딩페이지 완성**
  - 매력적이고 직관적인 제품 소개 페이지
  - Hero 섹션: 강력한 가치 제안과 CTA
  - Features 섹션: 6개 핵심 기능 소개
  - How It Works 섹션: 3단계 사용법 안내
  - 반응형 디자인 및 모바일 최적화
  - 데모 모드 및 임시 로그인 기능

#### 5.2 식단 기록 페이지 사용자 인터페이스 구현
- [ ] **메인 식단 기록 페이지**
  - 원클릭 업로드 버튼 구현
  - 카메라/갤러리 접근 기능
  - 로딩 상태 UI

- [ ] **업로드 완료 처리**
  - 성공/실패 알림 구현
  - 자동 페이지 전환 로직

#### 5.3 날짜별, 끼니별 식단 대시보드 구현
- [ ] **대시보드 메인 페이지**
  - 날짜별 식단 목록 조회
  - 끼니별 그룹화 UI
  - 총 칼로리 및 영양 정보 요약

- [ ] **식단 상세 조회**
  - 개별 식단 기록 상세보기
  - 이미지 표시
  - 영양 정보 상세 표시

### 📱 Phase 6: UI/UX 개선
#### 6.1 모바일 응답형 디자인 적용 (완료 ✅)
- [x] **반응형 레이아웃 구현**
  - 모바일 최적화 CSS 및 레이아웃
  - 터치 친화적 UI 요소 (44px 이상 터치 타겟)
  - 모바일 네비게이션 및 최적화

- [x] **사용자 경험 최적화**
  - 로딩 스피너 및 부드러운 애니메이션
  - 직관적인 아이콘 및 통일된 색상 팔레트
  - 접근성 개선 (ARIA 속성, 키보드 네비게이션)

📋 **[상세 Task 보기 - Phase 6-7](TASKS-DETAIL-PHASE6-7.md)**

### 🧪 Phase 7: 품질 보증
#### 7.1 기본 테스트 및 에러 핸딩 설정
- [ ] **에러 핸들링 개선**
  - 전역 에러 바운더리
  - API 에러 처리
  - 사용자 친화적 에러 메시지

- [ ] **기본 테스트 작성**
  - 주요 함수 단위 테스트
  - API 엔드포인트 테스트
  - 사용자 플로우 테스트

## Task 의존성 관계

```
1.1 → 1.2 → 1.3
  ↓
2.1 → 2.2 → 2.3
  ↓
3.1
  ↓
3.2 → 4.1 → 4.2 → 4.3
  ↓
5.1 → 5.2
  ↓
6.1
  ↓
7.1
```

## 개발 우선순위

### MVP 핵심 기능 (Phase 1-4)
1. 기본 프로젝트 구조 및 Supabase 설정
2. 사용자 인증
3. n8n 웹훅 연동
4. 시간 기반 자동 분류

### 사용자 경험 개선 (Phase 5-6)
1. 직관적 UI/UX
2. 모바일 최적화
3. 에러 처리 개선

### 품질 보증 (Phase 7)
1. 테스트 및 안정성 개선

## 성공 기준

- [ ] 사용자가 사진 한 장으로 식단 기록 완료
- [ ] 시간 기반 자동 끼니 분류 동작
- [ ] Supabase에 데이터 정상 저장
- [ ] 대시보드에서 기록 조회 가능
- [ ] 모바일에서 정상 동작

## 참고 자료

- [PRD.md](PRD.md) - 상세 기능 요구사항
- Next.js App Router 문서
- Supabase 문서
- n8n 워크플로우 문서
